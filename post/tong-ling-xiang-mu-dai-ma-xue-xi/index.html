<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>铜陵项目代码学习 | Gridea</title>
<meta name="description" content="">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://spark-wz.github.io/favicon.ico?v=1575951819247">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://spark-wz.github.io/styles/main.css">


<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://spark-wz.github.io">Gridea</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                首页
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                归档
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                标签
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                关于
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>铜陵项目代码学习</h1>
            <p class="article-meta">
              2019-11-11
              
            </p>
            
            <div class="post-content">
              <p><strong>ThreadLocal</strong><br>
ThreadLocal是一个线程每部的存储类，可以在既定线程内存储数据，数据存储之后，只有指定线程才会得到数据。<br>
static final ThreadLocal<T> sThreadLocal = new ThreadLocal<T>();<br>
sThreadLocal.set()<br>
sThreadLocal.get()<br>
<strong>spring动态切换多数据源解决方案</strong><br>
1.建立一个数据源的名称常量类，建立一个获得和设置上下文环境的类，主要负责改变上下文数据源的名称，两个类可以合并。<br>
<img src="https://spark-wz.github.io/post-images/1574906751791.png" alt=""><br>
2.建立动态数据源类，这个类必须继承AbstractRoutingDataSource且实现方法datermineCurrentLookupKey，该方法返回一个key，一般是Object；<br>
<img src="https://spark-wz.github.io/post-images/1574907519526.png" alt=""><br>
3.编写spring的配置多个数据源<br>
<img src="https://spark-wz.github.io/post-images/1574907652472.png" alt=""><br>
<strong>config文件</strong><br>
配置数据源<br>
配置动态数据源<br>
<img src="https://spark-wz.github.io/post-images/1574911348867.png" alt=""><br>
<strong>MyBatis 逆向工程 Generator＋Example</strong><br>
<em><strong>Generator代码生成器</strong></em><br>
1.添加依赖和配置<br>
<img src="https://spark-wz.github.io/post-images/1574912134286.png" alt=""><br>
2.在generatorConfig.xml配置数据库驱动，生成实体（模型），xml文件，dao接口的包名和位置，还有对应的数据库表和实体类。<br>
<img src="https://spark-wz.github.io/post-images/1574912327152.png" alt=""><br>
3.在maven中启动<br>
<img src="https://spark-wz.github.io/post-images/1574912374990.png" alt=""><br>
<em><strong>example用法</strong></em><br>
int deleteByPrimaryKey(Integer id) thorws SQLException    按主键删除<br>
int deleteByExample(UserExample example) thorws SQLException    按条件查询<br>
String/Integer insert(User record) thorws SQLException    插入数据（返回值为ID）<br>
User selectByPrimaryKey(Integer id) thorws SQLException    按主键查询<br>
updateByExample     更新所有字段<br>
updateByExample     根据条件更新想要更新的字段<br>
updateByPrimaryKeySelective    根据主键更新密码<br>
updateByPrimaryKey    根据主键更新除了主键之外的<br>
setOrderByClause(&quot;ID DESC&quot;)id排序 也可以传多个参数 (&quot;<code>index</code> ASC,id ASC&quot;)<br>
ListselectByExample(UserExample example) thorws SQLException    按条件查询<br>
ListselectByExampleWithBLOGs(UserExample example) thorws SQLException    按条件查询（包括BLOB字段）。只有当数据表中的字段类型有为二进制的才会产生。<br>
insert   插入数据          insertSelective      插入不为null的数据<br>
int updateByPrimaryKey(User record) thorws SQLException    按主键更新<br>
int updateByPrimaryKeySelective(User record) thorws SQLException    按主键更新值不为null的字段<br>
int updateByExample(User record, UserExample example) thorws SQLException    按条件更新<br>
int updateByExampleSelective(User record, UserExample example) thorws SQLException    按条件更新值不为null的字段<br>
setOrderByClause   排序    列名是条件<br>
example.createCriteria().andEqualTo(&quot;terminalName&quot;, &quot;计量现场服务终端&quot;);<br>
条件查询用的是属性名  终端名称是计量现场服务终端<br>
example.createCriteria().andGreaterThan(&quot;id&quot;,3); 厂商id&gt;3<br>
<img src="https://spark-wz.github.io/post-images/1573009821363.png" alt=""><br>
<strong>spring刷新数据源</strong><br>
@Scheduled注解配合@EnableScheduling使用，计划任务执行<br>
将service注入，配置数据源刷新时间，调用service中更新方法<br>
<img src="https://spark-wz.github.io/post-images/1574913872984.png" alt=""><br>
@Async 加上这个注解可以异步执行</p>
<pre><code>*lambok**
懒人神器，帮你自动生成get，set之类的方法
安装方法：idea中下载lambok
![](https://spark-wz.github.io/post-images/1573562104882.png)
常用方法：
实体类或者dto类中导入lambok
加上data注解直接修饰所有getter变量，setter所有不为final的变量[]()
![](https://spark-wz.github.io/post-images/1573562183069.png) 

快捷键：alt +7 查看类中的所有方法
controller中在参数前边加@RequestBody注解，且只能加一次，
</code></pre>
<ol>
<li>@PathVariable注解，绑定参数（映射url绑定的占位符）@PathVariable(value=&quot;id&quot;) String id  可以在url中直接写id<br>
2.@RequestHeader 注解，可以把Request请求header部分的值绑定到方法的参数上。<img src="https://spark-wz.github.io/post-images/1575362303722.png" alt=""></li>
<li></li>
</ol>
<p>@CookieValue 可以把Request header中关于cookie的值绑定到方法的参数上。<br>
图片示例<br>
4.@RequestParam   常用来处理简单类型的绑定<br>
通过Request.getParameter() 获取的String可直接转换为简单类型的情况<br>
<img src="https://spark-wz.github.io/post-images/1575364405727.png" alt=""></p>
<pre><code>**Criteria用法**
Excample.or()相当于 Example.Criteria criteria = Example.createCriteria;
criteria.andTestIsNull();    -里面的参数必须为null
criteria.andTestIsNotNull();     -里面的参数必须不是null
criteria.andTestEqualTo();     String  等于  
criteria.andTestBetween();     String1,String2 在区间
criteria.andTestGreaterThan();   String  大于
criteria.andTestGreaterThanOrEqualTo();   String  大于等于
criteria.andTestIn();   String 
criteria.andTestLessThan();   String 小于
criteria.andTestLessThanOrEqualTo();   String  小于等于
criteria.andTestLike();  String
criteria.andTestNotBetween();   String 小于等于
criteria.andTestNotEqualTo();   String
criteria.andTestNotIn();   String 
criteria.andTestNotLike();  String
criteria.isValid();  return boolean   检查对象是否实例化
criteria.notify();   线程通知
criteria.wait();     线程等待
</code></pre>
<p>wait() 和 notify()必须配合synchrozied关键字使用，无论是wait()还是notify()都需要首先获取目标对象的一个监听器。<br>
wait()会释放锁，而notify()不释放锁。<br>
1线程被wait();之后释放锁然后2线程执行，2线程执行notify之后，2线程执行完程序1线程才会执行。</p>
<pre><code>**时间戳**
js获得当前时间时间戳
new Date().getTime();
new Date().valueOf();
Date.parse(new Date());
</code></pre>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
            <div class="next-post">
              <div class="next">
                下一篇
              </div>
              <a href="https://spark-wz.github.io/post/bu-shu-ming-ling">
                <h3 class="post-title">
                  部署命令
                </h3>
              </a>
            </div>
          
        </div>
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://spark-wz.github.io/images/avatar.png?v=1575951819247" class="no-responsive avatar">
    <div class="text-muted"></div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      最新文章
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://spark-wz.github.io/post/tong-ling-xiang-mu-dai-ma-xue-xi">铜陵项目代码学习</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/bu-shu-ming-ling">部署命令</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/dong-tai-sql-xue-xi">动态sql学习</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/mybatis-ni-xiang-gong-cheng-bi-ji">MyBatis逆向工程笔记</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/web-service-xue-xi">Web service学习</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/duan-kou-hao">命令</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/java-ji-chu-mian-shi-zheng-li">java基础面试整理</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/mian-shi-ri-chang-zheng-li">面试日常整理</a>
            </li>
          
        
          
            <li>
              <a href="https://spark-wz.github.io/post/hello-gridea">Nginx</a>
            </li>
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      标签列表
    </div>
    <div class="row">
      
        <a href="https://spark-wz.github.io/tag/x0D9AKioe" class="badge ">
          Gridea
        </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://spark-wz.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>




  </body>
</html>
